import{j as e,r as d,f as h,h as j,_ as N,i as v,b as y,c as w}from"./index-8a1d3cca.js";import{A as E}from"./index.esm-fdfbfd57.js";import{b as S,c as k,d as C,I as D,e as F,D as B,a as R,R as _,M as I,B as T}from"./ReadmeBtn-c6e4c2e1.js";import{B as p}from"./supabaseClient-40abd7ef.js";import{d as f}from"./index.esm-520ece2f.js";import{b as z,c as A}from"./index.esm-ecfd2bee.js";import{u as m}from"./iconBase-74b0cd5c.js";import{u as g}from"./useDispatch-76832de9.js";import{i as U}from"./utils-30caca54.js";import{G as L}from"./GoogleAds-783af57b.js";function P({map:s}){const{t:a}=m(),i=s.mid?`?mid=${s.mid}`:`?uuid=${s.uuid}`,o=window.location.href+i+"&name="+s.name,n=s.mid||s.uuid;async function l(t){try{await navigator.clipboard.writeText(t),alert(a("index.copyedMid",{mid:t}))}catch(u){console.error(u)}}const c=()=>{navigator.share?navigator.share({title:document.title,text:`${a("common.map")}${a("index.share")} - `+s.name,url:o}).then(()=>console.log("成功！")).catch(t=>console.log("發生錯誤",t)):console.log(o)};return e.jsx(e.Fragment,{children:e.jsxs(S,{className:"modalContent","aria-describedby":void 0,children:[e.jsx(k,{children:e.jsx(C,{children:a("index.share")+a("common.map")})}),e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-lg text-center",children:[e.jsx(f,{size:24,className:"inline-block mr-2",color:s.mid?"#5bb531":"#3E8EEF"}),s.name]}),e.jsxs("div",{className:"row",children:[e.jsxs("label",{className:"w-full block mb-2",htmlFor:"shareMid",children:[a("common.map")," id："]}),e.jsxs("div",{className:"inputGroup",children:[e.jsx(D,{className:"grow",name:"shareMid",type:"text",value:n,readOnly:!0}),e.jsx("div",{className:"shrink-0 ml-2 bg-slate-100 p-2 border border-slate-400",onClick:()=>l(s.mid||s.uuid),children:e.jsx(z,{size:"20",color:"#666"})})]})]})]}),e.jsx(F,{children:e.jsx(p,{type:"submit",onClick:c,children:a("index.share")})})]})})}function $({map:s}){const{t:a}=m();return e.jsxs(B,{children:[e.jsx(R,{asChild:!0,children:e.jsxs(p,{className:"w-full rounded-none text-white bg-green-600",children:[e.jsx(A,{className:"mr-2"}),a("index.share")]})}),e.jsx(P,{map:s})]})}function G({item:s,onEditMap:a}){const{t:i}=m(),[o]=d.useState(s),n=h(),l=g(),c=t=>{localStorage.showedLayer="",l(j(t.id)),n("/")};return e.jsxs("div",{className:"border border-gray-300 cursor-pointer flex flex-col justify-between relative","data-cy":"mapsBtns",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center my-4 px-4 grow",onClick:()=>c(o),children:[e.jsx(f,{size:44,color:s.mid?"#5bb531":"#3E8EEF"}),e.jsx("p",{className:"text-center mt-2",children:s.name})]},s.id),e.jsxs("div",{className:"flex",children:[e.jsx(p,{className:"w-full rounded-none bg-slate-600 text-white",onClick:()=>a(s),children:i("common.edit")}),(s.mid||s.uuid)&&e.jsx($,{map:s})]})]})}const O=d.lazy(()=>N(()=>import("./EditMapModal-7ce6fbe6.js"),["assets/EditMapModal-7ce6fbe6.js","assets/index-8a1d3cca.js","assets/index-5d01481f.css","assets/supabaseClient-40abd7ef.js","assets/ReadmeBtn-c6e4c2e1.js","assets/iconBase-74b0cd5c.js","assets/utils-30caca54.js","assets/useDispatch-76832de9.js","assets/index.esm-fdfbfd57.js"]));function q(){const{t:s}=m(),[a]=v(),i=d.useRef(),[o,n]=d.useState(null),l=a.get("mid"),c=a.get("uuid");d.useEffect(()=>{l&&i.current.click(),c&&i.current.click()},[l,c,i]);const{mymaps:t}=y(r=>r.maps),u=h(),x=g(),b=r=>{n(r)},M=()=>{const r=U();x(w(r)),x(j(r.id)),u("/")};return e.jsxs("div",{className:"p-4",children:[t.length===0&&e.jsx(_,{}),e.jsx("button",{className:"w-full h-12 border-dashed border-2 text-gray-500",children:e.jsxs("div",{className:"flex justify-center relative","data-cy":"importMap",children:[e.jsx(I,{importAsNewMap:!0,className:"absolute",type:"full",ref:i}),e.jsx(T,{size:24}),e.jsx("p",{className:"ml-2",children:s("mapUpload.importMap")})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[t.map(r=>e.jsx(G,{onEditMap:b,item:r},r.id)),e.jsxs("div",{onClick:M,className:"p-4 border border-gray-300 flex flex-col justify-center items-center cursor-pointer","data-cy":"add-blank-map",children:[e.jsx(E,{size:44,color:"#999"}),e.jsx("p",{className:"text-center mt-2 text-[#999]",children:s("index.addNewMap")})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(L,{})}),e.jsx(d.Suspense,{fallback:e.jsx("div",{children:"Loading..."}),children:o&&e.jsx(O,{open:o,onClose:()=>n(null),map:o,onUploaded:r=>n(r)})})]})}function se(){return e.jsx("div",{className:"w-full h-full",children:e.jsx(q,{})})}export{se as default};
