import{r as h,b as j,j as e,c as f,h as S,f as g,i as N,k as E}from"./index-d4c0aa35.js";import{A as D}from"./index.esm-c505d778.js";import{D as b,a as x,b as M,c as w,d as v,I as y,e as C,R as F,M as B,B as R}from"./ReadmeBtn-35e8ef26.js";import{d as k}from"./index.esm-97e93b67.js";import{B as m}from"./button-044e4012.js";import{b as z,i as I}from"./utils-3d32e68b.js";import{u}from"./iconBase-fa96f2cb.js";import{u as p}from"./useDispatch-5d8e2ac9.js";import{b as T,c as A}from"./index.esm-1f0a606d.js";import{G as U}from"./GoogleAds-3cc205dd.js";function $({map:s}){const{t:a}=u(),[t,n]=h.useState(""),{mymaps:c}=j(r=>r.maps),l=p(),d=()=>{const r=z(s);r.name=t,l(f(r))},i=()=>{const r=c.filter(o=>o.id!==s.id);l(S(r))};return e.jsxs(b,{children:[e.jsx(x,{asChild:!0,children:e.jsx(m,{className:"w-full rounded-none bg-slate-600 text-white",children:a("common.edit")})}),e.jsxs(M,{className:"modalContent","aria-describedby":void 0,children:[e.jsx(w,{children:e.jsx(v,{children:a("common.edit")+a("common.map")})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 -mb-3",children:a("common.map")+a("common.name")}),e.jsx(y,{id:"mapName",defaultValue:s.name,onChange:r=>n(r.target.value),className:"w-full"})]}),e.jsxs(C,{className:"w-full flex flex-row flex-nowrap items-center",children:[e.jsx(x,{asChild:!0,children:e.jsx(m,{className:"w-[90px] shrink-0 mr-8 text-red-700 hover:text-red-500",variant:"ghost",size:"sm",onClick:i,children:a("common.delete")+a("common.map")})}),e.jsx(x,{asChild:!0,children:e.jsx(m,{className:"grow shrink-0",type:"submit",onClick:d,children:a("common.save")})})]})]})]})}function G({map:s}){const{t:a}=u(),t=s.mid?`?mid=${s.mid}`:`?uuid=${s.uuid}`,n=window.location.href+t+"&name="+s.name,c=s.mid||s.uuid;async function l(i){try{await navigator.clipboard.writeText(i),alert(a("index.copyedMid",{mid:i}))}catch(r){console.error(r)}}const d=()=>{navigator.share?navigator.share({title:document.title,text:`${a("common.map")}${a("index.share")} - `+s.name,url:n}).then(()=>console.log("成功！")).catch(i=>console.log("發生錯誤",i)):console.log(n)};return e.jsx(e.Fragment,{children:e.jsxs(M,{className:"modalContent",children:[e.jsx(w,{children:e.jsx(v,{children:a("index.share")+a("common.map")})}),e.jsxs(e.Fragment,{children:[e.jsxs("h1",{className:"text-lg text-center",children:[e.jsx(k,{size:24,className:"inline-block mr-2",color:s.mid?"#5bb531":"#3E8EEF"}),s.name]}),e.jsxs("div",{className:"row",children:[e.jsxs("label",{className:"w-full block mb-2",htmlFor:"shareMid",children:[a("common.map")," id："]}),e.jsxs("div",{className:"inputGroup",children:[e.jsx(y,{className:"grow",name:"shareMid",type:"text",value:c,readOnly:!0}),e.jsx("div",{className:"shrink-0 ml-2 bg-slate-100 p-2 border border-slate-400",onClick:()=>l(s.mid||s.uuid),children:e.jsx(T,{size:"20",color:"#666"})})]})]})]}),e.jsx(C,{children:e.jsx(m,{type:"submit",onClick:d,children:a("index.share")})})]})})}function L({map:s}){const{t:a}=u();return e.jsxs(b,{children:[e.jsx(x,{asChild:!0,children:e.jsxs(m,{className:"w-full rounded-none text-white bg-green-600",children:[e.jsx(A,{className:"mr-2"}),a("index.share")]})}),e.jsx(G,{map:s})]})}function O({item:s}){const[a]=h.useState(s),t=g(),n=p(),c=l=>{localStorage.showedLayer="",n(N(l.id)),t("/")};return e.jsxs("div",{className:"border border-gray-300 cursor-pointer flex flex-col justify-between relative","data-cy":"mapsBtns",children:[e.jsxs("div",{className:"flex flex-col justify-center items-center my-4 px-4 grow",onClick:()=>c(a),children:[e.jsx(k,{size:44,color:s.mid?"#5bb531":"#3E8EEF"}),e.jsx("p",{className:"text-center mt-2",children:s.name})]},s.id),e.jsxs("div",{className:"flex",children:[e.jsx($,{map:s}),(s.mid||s.uuid)&&e.jsx(L,{map:s})]})]})}function P(){const{t:s}=u(),[a]=E(),t=h.useRef(),n=a.get("mid"),c=a.get("uuid");h.useEffect(()=>{n&&t.current.click(),c&&t.current.click()},[n,c,t]);const{mymaps:l}=j(o=>o.maps),d=g(),i=p(),r=()=>{const o=I();i(f(o)),i(N(o.id)),d("/")};return e.jsxs("div",{className:"p-4",children:[l.length===0&&e.jsx(F,{}),e.jsx("button",{className:"w-full h-12 border-dashed border-2 text-gray-500",children:e.jsxs("div",{className:"flex justify-center relative","data-cy":"importMap",children:[e.jsx(B,{importAsNewMap:!0,className:"absolute",type:"full",ref:t}),e.jsx(R,{size:24}),e.jsx("p",{className:"ml-2",children:s("mapUpload.importMap")})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-4",children:[l.map(o=>e.jsx(O,{item:o},o.id)),e.jsxs("div",{onClick:r,className:"p-4 border border-gray-300 flex flex-col justify-center items-center cursor-pointer","data-cy":"add-blank-map",children:[e.jsx(D,{size:44,color:"#999"}),e.jsx("p",{className:"text-center mt-2 text-[#999]",children:s("index.addNewMap")})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(U,{})})]})}function _(){return e.jsx("div",{className:"w-full h-full",children:e.jsx(P,{})})}export{_ as default};
