import{j as e,r as x,b as M,c as N,m as C,d as D}from"./index-f433997a.js";import{d as S}from"./index.esm-558cdf52.js";import{a as E,b as F}from"./index.esm-67d1cb07.js";import{a as L,b as z,c as T}from"./index.esm-2c713c8b.js";import{f as B,b as G,g as O,d as H}from"./utils-2d860b5a.js";import{I as P}from"./Icon-e13f9d7d.js";import{f as R,B as b}from"./button-c80087dc.js";import{D as _,a as v,b as U,c as V,d as J,e as W}from"./dialog-7aee5936.js";import{G as $,u as q}from"./jszip.min-25157898.js";import{I as A}from"./input-938f7d21.js";import{u as w}from"./useDispatch-b8c750aa.js";function K({description:s}){const o=B(s);return e.jsx("div",{className:"p-4 min-h-[30px] break-all border-b-2",children:e.jsx("p",{dangerouslySetInnerHTML:{__html:o}})})}function Q(s){return $({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}}]})(s)}const I=x.forwardRef(({className:s,...o},d)=>e.jsx("textarea",{className:R("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:d,...o}));I.displayName="Textarea";function X({marker:s,layerId:o,className:d}){const{t}=q(),[f,k]=x.useState(s.name),[h,u]=x.useState(s.description),{defaultMap:m}=M(a=>a.maps),p=w(),i=G(m),c=()=>{i.data.forEach(a=>{a.id===o&&a.markers.forEach(l=>{l.id===s.id&&(l.name=f,l.description=h)})}),p(N(i))},j=()=>{i.data.forEach(a=>{a.markers=a.markers.filter(l=>l.id!==s.id)}),p(N(i))};return e.jsxs(_,{children:[e.jsx(v,{children:e.jsx("div",{className:"w-6 h-6",children:e.jsx(Q,{className:d,"data-cy":"editMarkItem",size:24})})}),e.jsxs(U,{className:"modalContent moreUp","data-cy":"editMarkItemModal",children:[e.jsx(V,{children:e.jsx(J,{children:t("common.edit")+t("common.mark")})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 -mb-3",children:t("common.mark")+t("common.name")}),e.jsx(A,{defaultValue:f,onChange:a=>k(a.target.value),className:"w-full mb-4","data-cy":"markNameInput"}),e.jsx("label",{className:"text-sm text-slate-500 -mb-3",children:t("common.mark")+t("common.description")}),e.jsx(I,{defaultValue:h,onChange:a=>u(a.target.value),className:"w-full h-24","data-cy":"markDescriptionInput"})]}),e.jsxs(W,{className:"w-full flex flex-row flex-nowrap items-center",children:[e.jsx(v,{asChild:!0,children:e.jsx(b,{className:"w-[90px] shrink-0 mr-8 text-red-700 hover:text-red-500",variant:"ghost",size:"sm",onClick:j,"data-cy":"deleteMarkItem",children:t("common.delete")+t("common.mark")})}),e.jsx(v,{asChild:!0,children:e.jsx(b,{className:"grow shrink-0",type:"submit",onClick:c,"data-cy":"saveMarkItem",children:t("common.save")})})]})]})]})}function de({item:s,layerId:o,readonly:d=!1}){const[t,f]=x.useState(!1),k=O(s),h=H(s),u=w(),{favorites:m,isEditMode:p,selectedMarkerItem:i}=M(n=>n.maps),c=x.useMemo(()=>!d&&p,[d,p]),j=m.find(n=>n.id===s.id),a=n=>{f(r=>!r)},l=n=>{n.stopPropagation();let r="";j?r=m.filter(g=>g.id!==s.id):r=[...m,s],u(C(r)),localStorage.setItem("favorites",JSON.stringify(r))},y=n=>{n.stopPropagation();let r="";i.includes(s.id)?r=i.filter(g=>g!==s.id):r=[...i,s.id],u(D(r))};return e.jsxs("li",{className:"list-none","data-cy":"markItem",children:[e.jsxs("div",{className:"min-h-[3rem] flex justify-between items-center px-2 py-2 border-b relative",children:[e.jsxs("div",{className:"w-6 h-6 shrink-0 mr-2",children:[e.jsx("div",{className:c?"slideOutLeft":"slideIn",onClick:l,"data-cy":"triggerFavo",children:j?e.jsx(L,{size:24,fill:"#f00"}):e.jsx(z,{size:24,fill:"#f00"})}),e.jsx("div",{onClick:y,className:c?"slideIn":"slideOutLeft",children:i.includes(s.id)?e.jsx(E,{size:24,fill:"#16a34a"}):e.jsx(F,{size:24,fill:"#16a34a"})})]}),e.jsx("div",{className:"w-6 h-6 shrink-0 mr-2",children:e.jsx("a",{href:h,target:"_blank",rel:"noreferrer",children:e.jsx(P,{iconId:s.icon})})}),e.jsxs("p",{className:"text-md mr-4 grow",onClick:a,children:[s.name,s.description&&e.jsx(T,{className:`inline-block transition-transform ${t?"":"-rotate-90"}`,size:24})]}),e.jsxs("div",{className:"flex shrink-0 items-center justify-end mr-2 space-x-3 w-6",children:[e.jsx(X,{className:c?"slideIn":"slideOutRight",marker:s,layerId:o}),e.jsx("a",{href:k,className:c?"slideOutRight":"slideIn",target:"_blank",rel:"noreferrer",children:e.jsx(S,{size:24,fill:"#666"})})]})]}),s.description&&t&&e.jsx(K,{description:s.description})]})}export{Q as F,de as M};
