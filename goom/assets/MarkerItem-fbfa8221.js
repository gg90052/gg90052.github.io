import{j as e,r as f,b as I,d as M,c as b,k as D,e as S}from"./index-752a7486.js";import{d as E}from"./index.esm-9969c90a.js";import{a as F,b as L}from"./index.esm-d45110f8.js";import{a as z,b as T,c as B}from"./index.esm-27cb2e57.js";import{f as G,b as O,g as H,d as P}from"./utils-c22602a5.js";import{I as R}from"./Icon-3c031684.js";import{c as _,B as w}from"./index-c18687c5.js";import{D as U,a as N,b as V,c as J,d as W,e as $}from"./dialog-a3a6cad8.js";import{G as q,u as A}from"./jszip.min-6b47eacb.js";import{I as K}from"./input-f0310597.js";import{u as y}from"./useDispatch-9bb8c2c7.js";function Q({description:s}){const d=G(s);return e.jsx("div",{className:"p-4 min-h-[30px] break-all border-b-2",children:e.jsx("p",{dangerouslySetInnerHTML:{__html:d}})})}function X(s){return q({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}},{tag:"path",attr:{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"}}]})(s)}const C=f.forwardRef(({className:s,...d},c)=>e.jsx("textarea",{className:_("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",s),ref:c,...d}));C.displayName="Textarea";function Y({marker:s,layerId:d,className:c}){const{t:r}=A(),[x,k]=f.useState(s.name),[u,h]=f.useState(s.description),{mymaps:m,defaultMap:p}=I(n=>n.maps),l=y(),i=O(p),j=()=>{i.data.forEach(t=>{t.id===d&&t.markers.forEach(a=>{a.id===s.id&&(a.name=x,a.description=u)})});const n=m.map(t=>t.id===p.id?i:t);l(M(n)),l(b(i))},g=()=>{i.data.forEach(t=>{t.markers=t.markers.filter(a=>a.id!==s.id)});const n=m.map(t=>t.id===p.id?i:t);l(M(n)),l(b(i))};return e.jsxs(U,{children:[e.jsx(N,{children:e.jsx("div",{className:"w-6 h-6",children:e.jsx(X,{className:c,"data-cy":"editMarkItem",size:24})})}),e.jsxs(V,{className:"modalContent moreUp","data-cy":"editMarkItemModal",children:[e.jsx(J,{children:e.jsx(W,{children:r("common.edit")+r("common.mark")})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-slate-500 -mb-3",children:r("common.mark")+r("common.name")}),e.jsx(K,{defaultValue:x,onChange:n=>k(n.target.value),className:"w-full mb-4","data-cy":"markNameInput"}),e.jsx("label",{className:"text-sm text-slate-500 -mb-3",children:r("common.mark")+r("common.description")}),e.jsx(C,{defaultValue:u,onChange:n=>h(n.target.value),className:"w-full h-24","data-cy":"markDescriptionInput"})]}),e.jsxs($,{className:"w-full flex flex-row flex-nowrap items-center",children:[e.jsx(N,{asChild:!0,children:e.jsx(w,{className:"w-[90px] shrink-0 mr-8 text-red-700 hover:text-red-500",variant:"ghost",size:"sm",onClick:g,"data-cy":"deleteMarkItem",children:r("common.delete")+r("common.mark")})}),e.jsx(N,{asChild:!0,children:e.jsx(w,{className:"grow shrink-0",type:"submit",onClick:j,"data-cy":"saveMarkItem",children:r("common.save")})})]})]})]})}function ce({item:s,layerId:d,readonly:c=!1}){const[r,x]=f.useState(!1),k=H(s),u=P(s),h=y(),{favorites:m,isEditMode:p,selectedMarkerItem:l}=I(a=>a.maps),i=f.useMemo(()=>!c&&p,[c,p]),j=m.find(a=>a.id===s.id),g=a=>{x(o=>!o)},n=a=>{a.stopPropagation();let o="";j?o=m.filter(v=>v.id!==s.id):o=[...m,s],h(D(o)),localStorage.setItem("favorites",JSON.stringify(o))},t=a=>{a.stopPropagation();let o="";l.includes(s.id)?o=l.filter(v=>v!==s.id):o=[...l,s.id],h(S(o))};return e.jsxs("li",{className:"list-none","data-cy":"markItem",children:[e.jsxs("div",{className:"min-h-[3rem] flex justify-between items-center px-2 py-2 border-b relative",children:[e.jsxs("div",{className:"w-6 h-6 shrink-0 mr-2",children:[e.jsx("div",{className:i?"slideOutLeft":"slideIn",onClick:n,"data-cy":"triggerFavo",children:j?e.jsx(z,{size:24,fill:"#f00"}):e.jsx(T,{size:24,fill:"#f00"})}),e.jsx("div",{onClick:t,className:i?"slideIn":"slideOutLeft",children:l.includes(s.id)?e.jsx(F,{size:24,fill:"#16a34a"}):e.jsx(L,{size:24,fill:"#16a34a"})})]}),e.jsx("div",{className:"w-6 h-6 shrink-0 mr-2",children:e.jsx("a",{href:u,target:"_blank",rel:"noreferrer",children:e.jsx(R,{iconId:s.icon})})}),e.jsxs("p",{className:"text-md mr-4 grow",onClick:g,children:[s.name,s.description&&e.jsx(B,{className:`inline-block transition-transform ${r?"":"-rotate-90"}`,size:24})]}),e.jsxs("div",{className:"flex shrink-0 items-center justify-end mr-2 space-x-3 w-6",children:[e.jsx(Y,{className:i?"slideIn":"slideOutRight",marker:s,layerId:d}),e.jsx("a",{href:k,className:i?"slideOutRight":"slideIn",target:"_blank",rel:"noreferrer",children:e.jsx(E,{size:24,fill:"#666"})})]})]}),s.description&&r&&e.jsx(Q,{description:s.description})]})}export{X as F,ce as M};
