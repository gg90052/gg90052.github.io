import{f as te,j as e,r as n,m as S,s as ae,b as se,n as oe}from"./index-8a1d3cca.js";import{d as re,e as E,b as le,O as ne,u as T,W as ie,C as ce,f as de,S as pe,T as ge,D as ue,a as k,P as me,R as fe,c as d,g as O,s as xe}from"./supabaseClient-40abd7ef.js";import{u as f,G as he}from"./iconBase-74b0cd5c.js";import{u as P}from"./useLocalStorageState-28e2c647.js";import{j as ve}from"./utils-30caca54.js";import{L as je}from"./LogoIcon-9b2a5aeb.js";import{u as I}from"./useDispatch-76832de9.js";import{G as we}from"./GoogleAds-783af57b.js";function p({name:t,value:a,link:s,outsideLink:o,clickEvent:r,color:l}){const c=te(),D=()=>{s&&c(s),o&&window.open(o,"_blank","rel=noopener noreferrer"),r&&r()},h={yellow:"bg-[#ffc761] text-white",red:"bg-[#F36166] text-white",purple:"bg-[#BB7BE4] text-white",green:"bg-[#51C861] text-white",blue:"bg-[#00B2F7] text-white",logout:"bg-[#bc4c50] text-white !justify-center items-center !h-10"};return e.jsxs("div",{className:`h-24 rounded-2xl w-full flex flex-col-reverse justify-between items-start px-4 py-3 ${h[l]}`,onClick:D,children:[e.jsx("p",{children:t}),a&&e.jsx("p",{className:"text-lg self-center bg-[rgba(0,0,0,.3)] rounded-2xl px-3",children:a})]})}var L="AlertDialog",[Ae,et]=re(L,[E]),i=E(),$=t=>{const{__scopeAlertDialog:a,...s}=t,o=i(a);return e.jsx(fe,{...o,...s,modal:!0})};$.displayName=L;var Ne="AlertDialogTrigger",M=n.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...o}=t,r=i(s);return e.jsx(le,{...r,...o,ref:a})});M.displayName=Ne;var De="AlertDialogPortal",B=t=>{const{__scopeAlertDialog:a,...s}=t,o=i(a);return e.jsx(me,{...o,...s})};B.displayName=De;var be="AlertDialogOverlay",G=n.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...o}=t,r=i(s);return e.jsx(ne,{...r,...o,ref:a})});G.displayName=be;var g="AlertDialogContent",[ye,Ce]=Ae(g),z=n.forwardRef((t,a)=>{const{__scopeAlertDialog:s,children:o,...r}=t,l=i(s),c=n.useRef(null),D=T(a,c),h=n.useRef(null);return e.jsx(ie,{contentName:g,titleName:H,docsSlug:"alert-dialog",children:e.jsx(ye,{scope:s,cancelRef:h,children:e.jsxs(ce,{role:"alertdialog",...l,...r,ref:D,onOpenAutoFocus:de(r.onOpenAutoFocus,u=>{var R;u.preventDefault(),(R=h.current)==null||R.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[e.jsx(pe,{children:o}),e.jsx(Se,{contentRef:c})]})})})});z.displayName=g;var H="AlertDialogTitle",x=n.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...o}=t,r=i(s);return e.jsx(ge,{...r,...o,ref:a})});x.displayName=H;var F="AlertDialogDescription",U=n.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...o}=t,r=i(s);return e.jsx(ue,{...r,...o,ref:a})});U.displayName=F;var Re="AlertDialogAction",V=n.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...o}=t,r=i(s);return e.jsx(k,{...r,...o,ref:a})});V.displayName=Re;var W="AlertDialogCancel",Y=n.forwardRef((t,a)=>{const{__scopeAlertDialog:s,...o}=t,{cancelRef:r}=Ce(W,s),l=i(s),c=T(a,r);return e.jsx(k,{...l,...o,ref:c})});Y.displayName=W;var Se=({contentRef:t})=>{const a=`\`${g}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${g}\` by passing a \`${F}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${g}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return n.useEffect(()=>{var o;document.getElementById((o=t.current)==null?void 0:o.getAttribute("aria-describedby"))||console.warn(a)},[a,t]),null},_e=$,Ee=M,Te=B,q=G,J=z,K=V,Q=Y,X=x,Z=U;const y=_e,C=Ee,ke=Te,ee=n.forwardRef(({className:t,...a},s)=>e.jsx(q,{className:d("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s}));ee.displayName=q.displayName;const v=n.forwardRef(({className:t,...a},s)=>e.jsxs(ke,{children:[e.jsx(ee,{}),e.jsx(J,{ref:s,className:d("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg md:w-full",t),...a})]}));v.displayName=J.displayName;const j=({className:t,...a})=>e.jsx("div",{className:d("flex flex-col space-y-2 text-center sm:text-left",t),...a});j.displayName="AlertDialogHeader";const w=({className:t,...a})=>e.jsx("div",{className:d("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a});w.displayName="AlertDialogFooter";const Oe=n.forwardRef(({className:t,...a},s)=>e.jsx(X,{ref:s,className:d("text-lg font-semibold",t),...a}));Oe.displayName=X.displayName;const Pe=n.forwardRef(({className:t,...a},s)=>e.jsx(Z,{ref:s,className:d("text-sm text-muted-foreground",t),...a}));Pe.displayName=Z.displayName;const A=n.forwardRef(({className:t,...a},s)=>e.jsx(K,{ref:s,className:d(O(),t),...a}));A.displayName=K.displayName;const N=n.forwardRef(({className:t,...a},s)=>e.jsx(Q,{ref:s,className:d(O({variant:"outline"}),"mt-2 sm:mt-0",t),...a}));N.displayName=Q.displayName;function Ie(){const{t}=f();return e.jsxs(y,{children:[e.jsx(C,{children:e.jsx(p,{name:t("settings.clearAllData"),color:"red"})}),e.jsxs(v,{className:"w-[60%]",children:[e.jsx(j,{children:e.jsx(x,{children:t("settings.clearConfirm")})}),e.jsxs(w,{className:"flex flex-nowrap flex-row items-center justify-center",children:[e.jsx(N,{className:"mt-0 mr-2",children:t("common.cancel")}),e.jsx(A,{className:"text-red-500 border-none bg-transparent hover:bg-red-500 hover:text-white shadow-none",onClick:()=>{localStorage.clear(),window.location.reload()},children:t("common.delete")})]})]})]})}const b={google:"Google Map",naver:"Naver Map"};ve()&&(b.apple="Apple Map");function Le(){const t=n.useRef(),{t:a}=f(),[s,o]=P("google","defaultApp");return e.jsxs(y,{children:[e.jsx(C,{children:e.jsx(p,{name:a("settings.openMapApp"),value:b[s],color:"purple"})}),e.jsxs(v,{className:"w-[80%] max-w-xs",children:[e.jsx(j,{children:e.jsx(x,{children:a("settings.selectApp")})}),e.jsx("select",{ref:t,defaultValue:s,className:"border h-8 shadow-sm",children:Object.entries(b).map(([r,l])=>e.jsx("option",{value:r,children:l},r))}),e.jsxs(w,{className:"flex flex-nowrap flex-row items-center justify-center",children:[e.jsx(N,{className:"mt-0 mr-2",children:a("common.cancel")}),e.jsx(A,{onClick:()=>{o(t.current.value)},children:a("common.confirm")})]})]})]})}const _={en:"English",zh_tw:"繁體中文",jp:"日本語"};function $e(){const{t,i18n:a}=f(),[s,o]=P("zh_tw","defaultLanguage"),r=n.useRef();return e.jsxs(y,{children:[e.jsx(C,{children:e.jsx(p,{name:"Language",value:_[s],color:"purple"})}),e.jsxs(v,{className:"w-[80%] max-w-xs",children:[e.jsx(j,{children:e.jsx(x,{children:t("settings.selectLanguage")})}),e.jsx("select",{ref:r,defaultValue:s,className:"border h-8 shadow-sm",children:Object.entries(_).map(([l,c])=>e.jsx("option",{value:l,children:c},l))}),e.jsxs(w,{className:"flex flex-nowrap flex-row items-center justify-center",children:[e.jsx(N,{className:"mt-0 mr-2",children:t("common.cancel")}),e.jsx(A,{onClick:()=>{o(r.current.value),a.changeLanguage(r.current.value)},children:t("common.confirm")})]})]})]})}function Me(t){return he({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M20.25 12a.75.75 0 01-.75.75H6.31l5.47 5.47a.75.75 0 11-1.06 1.06l-6.75-6.75a.75.75 0 010-1.06l6.75-6.75a.75.75 0 111.06 1.06l-5.47 5.47H19.5a.75.75 0 01.75.75z",clipRule:"evenodd"}}]})(t)}function Be({showBack:t=!1}){const{t:a}=f();return e.jsxs("div",{className:"w-full h-12 bg-slate-100 flex items-center justify-between p-4",children:[t&&e.jsxs(S,{className:"text-blue-500 w-12 flex-shrink-0 whitespace-nowrap",to:"/setting",children:[e.jsx(Me,{size:24,color:"#3b82f6",className:"inline-block -mt-[3px]"})," ",a("settings.settings")]}),e.jsxs("div",{className:"text-xl flex-grow flex items-center space-x-2",children:[e.jsx(je,{}),e.jsx("p",{children:a("settings.settings")}),e.jsx(S,{className:"text-xs text-gray-400",to:"/privacy",children:"Privacy Policy"})]}),e.jsx("div",{className:"w-12 flex-shrink-0",children:e.jsx("p",{className:"text-sm text-slate-300",children:"v1.7"})})]})}class m extends Error{}m.prototype.name="InvalidTokenError";function Ge(t){return decodeURIComponent(atob(t).replace(/(.)/g,(a,s)=>{let o=s.charCodeAt(0).toString(16).toUpperCase();return o.length<2&&(o="0"+o),"%"+o}))}function ze(t){let a=t.replace(/-/g,"+").replace(/_/g,"/");switch(a.length%4){case 0:break;case 2:a+="==";break;case 3:a+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Ge(a)}catch{return atob(a)}}function He(t,a){if(typeof t!="string")throw new m("Invalid token specified: must be a string");a||(a={});const s=a.header===!0?0:1,o=t.split(".")[s];if(typeof o!="string")throw new m(`Invalid token specified: missing part #${s+1}`);let r;try{r=ze(o)}catch(l){throw new m(`Invalid token specified: invalid base64 for part #${s+1} (${l.message})`)}try{return JSON.parse(r)}catch(l){throw new m(`Invalid token specified: invalid json for part #${s+1} (${l.message})`)}}const Fe="1082106606322-hd4f6u0m35htsr9i9b17ldr52dnvg5nb.apps.googleusercontent.com",Ue=({onLogin:t})=>{n.useEffect(()=>{window.google?(window.google.accounts.id.initialize({client_id:Fe,callback:a}),window.google.accounts.id.renderButton(document.getElementById("googleSignInDiv"),{theme:"outline",size:"large",text:"signin_with",shape:"pill",width:"320"})):console.error("Google Identity Services 未載入")});const a=s=>{const o=s.credential,r=He(o);t&&t(r)};return e.jsx("div",{className:"w-full h-16 flex items-center justify-center rounded-2xl bg-[#ffc761]",children:e.jsx("div",{id:"googleSignInDiv"})})};function Ve(){const t=I(),a=async s=>{const o={id:s.sub,email:s.email,name:s.name,avatar_url:s.picture};t(ae(o));const{data:r,error:l}=await xe.from("users").upsert(o,{onConflict:"id"});l?console.error("儲存用戶資料錯誤:",l):console.log("用戶資料儲存成功:",r)};return e.jsx(Ue,{onLogin:a})}function tt(){const{t}=f(),a=I(),{user:s}=se(r=>r.user);async function o(r){try{await navigator.clipboard.writeText(r),alert(t("settings.copyed",{url:r}))}catch(l){console.error(l)}}return e.jsxs("div",{className:"w-full h-[100dvh]",children:[e.jsx(Be,{showBack:!1}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 p-4",children:[e.jsx(p,{name:t("settings.instruction"),color:"blue",link:"/how-to-use"}),e.jsx(Le,{}),e.jsx(p,{name:t("settings.mymap"),color:"green",clickEvent:()=>{o("https://www.google.com/maps/d/")}}),e.jsx(Ie,{}),e.jsx(p,{name:t("settings.contact"),color:"blue",outsideLink:"https://www.facebook.com/GOOMmap"}),e.jsx($e,{}),e.jsx("div",{className:"col-span-2",children:s.id?e.jsx(p,{name:t("settings.logout")+` ${s.name}`,color:"logout",clickEvent:()=>a(oe())}):e.jsx(Ve,{})}),e.jsx(we,{})]})]})}export{tt as default};
